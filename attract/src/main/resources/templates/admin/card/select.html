<div th:fragment="main">
	<div class="breadcrumbs" id="breadcrumbs">
		<script type="text/javascript">
			try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
		</script>

		<ul class="breadcrumb">
			<li>
				<i class="icon-home home-icon"></i>
				<a th:href="@{/admin/}">Home</a>
			</li>
			<li>
				<a th:href="@{/admin/card/list/1}">名片管理</a>
			</li>
			<li class="active">名片审核</li>
		</ul><!-- .breadcrumb -->

		<div class="nav-search" id="nav-search">
			<form class="form-search">
				<span class="input-icon">
					<input type="text" placeholder="Search ..." class="nav-search-input" id="nav-search-input" autocomplete="off" />
					<i class="icon-search nav-search-icon"></i>
				</span>
			</form>
		</div><!-- #nav-search -->
	</div>

	<div class="page-content">
		<div class="row">
			<div class="col-xs-12">
				<!-- PAGE CONTENT BEGINS -->
				<div class="page-header">
					<h1>名片审核
					<small>
						<i class="icon-double-angle-right">
						名片详细资料
						</i>
					</small>
					</h1>
				</div>
				<div class="row">
					<div class="col-xs-12">
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 名片图片</label>
							<div class="col-sm-9" style="padding:5px;">
								<img width="300" th:src="@{'/'+${card.picture}}" />
							</div>
						</div>
						<div class="space-4"></div>
					
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 姓名 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.name}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 联系电话 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.telephone}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> E-mail </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.email}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 职位 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.job}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 公司名称 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.companyName}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 公司官网 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.websize}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 相关领域 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.domain}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 所需服务 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.demand}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 项目名称 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.projectName}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 项目阶段 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.projectStage}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
						
						<div class="form-group">
							<label class="col-sm-3 control-label no-padding-right" for="form-field-1"> 项目简介 </label>
							<div class="col-sm-9" style="padding:5px;" th:text="${card.projectBrief}"></div>
						</div>&nbsp;
						<div class="space-4"></div>
				
						<div class="clearfix form-actions">
							<div class="col-md-offset-3 col-md-9">
								<a class="btn btn-info" type="button" onclick="card_audit()">
									<i class="icon-ok bigger-110"></i>
									审核
								</a>
								&nbsp;&nbsp;&nbsp;
								<button class="btn" type="reset" onclick="history.go(-1)">
									<i class="icon-undo bigger-110"></i>
									返回
								</button>
							</div>
						</div>
							
					</div>
				</div>
				<!-- PAGE CONTENT ENDS -->
			</div><!-- /.col -->
		</div><!-- /.row -->
	</div><!-- /.page-content -->
	
	<div id="audit_div" class="modal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="blue bigger">审核确认</h4>
				</div>
				<div class="modal-body">
					<div class="row-fluid">
						若不通过，请填写原因。
					</div>
					<div class="space-6"></div>
					<div class="row-fluid">
						<form th:action="@{/admin/card/audit}" method="post" id="form_post">
							<input type="hidden" name="id" th:value="${card.id}" />
							<textarea class="textarea" name="content"></textarea>
						</form>
					</div>
				</div>
				
				<div class="modal-footer">
					<button class="btn btn-sm" onclick="form_submit(false)"><i class="icon-remove"></i> 不通过</button>
					<button class="btn btn-sm btn-primary" onclick="form_submit(true)" ><i class="icon-ok"></i> 通过</button>
				</div>
				
			</div>
		</div>
	</div>
	
	<script type="text/javascript" th:inline="javascript">
		/*<![CDATA[*/
	    function card_audit(){
	    	var status = [[${card.status}]];
	    	if(status != 'W'){
				ace_msg.danger('该名片已审核，请勿重复审核。');
				return;
			}
			$("#audit_div").modal("show");
		} 
		function form_submit(flag){
			var form = $("#form_post");
			var datas = form.serialize();
			var action = form.attr("action");
			if(!flag){
				var content = form.find("textarea[name='content']").val().trim();
				if(content == ''){
					$("#audit_div").modal("hide");
					ace_msg.danger('请填写审核不通过的原因。');
					return;
				}
			}
			$.ajax({
				url:action+"?flag="+flag,
				type:"POST",
				data:datas,
				dataType:'json',
				success:function(data){
					if(data.code == 0){
						go_back();
					}else{
						ace_msg.danger(data.msg);
					}
				}
			});
			
		}
		/*]]>*/           
	</script>
</div>